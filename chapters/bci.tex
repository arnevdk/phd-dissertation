Independent home use of a brain-computer interface by people with
amyotrophic lateral sclerosis.
\todo{Shortly describe challenges from the patient point of view, related to
this thesis}
\todo{do something with Wolpaw (2018) Independent home use of a brain-computer interface by people with
amyotrophic lateral sclerosis.}

\todo{
Locked-in -\> communicate
Paraplegic -\> walk again
tetraplegic, locked-in syndrome
Regaining capabilities and improving quality of life
Start from wolpaw examples, for spelling
Cite some catchy state of the art examples (walk again, speech avatar Metzger, handwriting
willet, neuralink)
}
\todo{put focus on communication BCI}
\section{A direct interface to the brain}
\comment{This section describes a bci in layman's terms, without too much
scientific background, jargon and literature, in the following sections of this
chapter a more scientific style is used}
A \ac{bci} reads your mind.
\ac{bci}s are an entertaining subject with many futuristic and more established
applications.
Devices processing direct inputs from the central nervous system can be
useful for rehabilitation, medical diagnosis or treatment.
They have always been especially promising as assistive technology for
paralyzed patients limited in their communication ability. \todo{expand more on this last
sentence, put patients first in introduction, see above}
Furthermore, they bring a new paradigm to human-computer interaction,
especially when paired with virtual or augmented reality.

Simply put, a \ac{bci} records the user's brain activity, then extracts some
relevant output from this brain activity and couples this output to a function
of a device.
Optionally, the user can then observe the action of the device and adapt their
behavior or brain activity accordingly, closing the loop
\footnote{
  \textcite{BCISociety2024} has recently formalized this into the
  following definition:
  \it``A brain-computer interface is a system that measures brain activity and
  converts it in (nearly) real-time into functionally useful outputs to replace,
  restore, enhance, supplement, and/or improve the natural outputs of the brain,
  thereby changing the ongoing interactions between the brain and its external or
  internal environments. It may additionally modify brain activity using targeted
  delivery of stimuli to create functionally useful inputs to the
  brain.''
}.

\fullpagefigct{figures/bci/bci_loop.pdf}{The \ac{bci} loop.
The user interacts with the \ac{bci} through a \ac{bci} paradigm, in this case involving
visual stimulation. Neural signals are recorded, and neurophysiological features
related to the paradigm are extracted. Using machine learning, a decision can
then be made based on these features, which can be presented back to the user.
In a closed-loop \ac{bci}, this feedback allows the user to adapt to the \ac{bci}.
}{fig:bci-loop}

Let's break this definition down and focus on its separate parts.
First of all, we need to identify a signal that is a direct representation of
what's going on in the brain.
Section~\ref{sec:bci-recording} gives an overview of the available options.
One might for instance measure the fluctuations in bloodflow to specific brain
regions that are more or less active at a given time with a scanner.
However, this signal reacts to slowly to reflect the real-time activity that is
of interest for our purposes, and it carries little information other than the
brain regions where it is originating.
A better candidate is the neuronal \emph{action potential}.
The brain consists 86 billion neurons, which are highly interconnected cells that are
the smallest units of information processing.
The action potential is an electrical pulse occurring when a neuron receives
input from another neuron and is activated.\todo{gross oversimplification,not
entirely true}
A neuron's action potential, or the combined action potentials of groups of
synchronized neurons, thus generate an electrical field in and near the brain,
which can be measured using electrodes.
Fluctuations in the brain's electrical potential can be faster and more
informative.

The recorded brain waves form only one part of the interaction scheme presented
in Figure~\ref{fig:bci-loop}.
It would make little sense to start digging around at random in all the brain
activity to try to extract the desired output.
It would help greatly if we knew what we are looking for.
For this reason, a \ac{bci} operates using a defined \emph{paradigm}, the manner in
which interaction is performed.
This usually means that the user is instructed to perform a specific task, like
attending a specific flickering stimulus.
We can now exploit background knowledge from prior neuroscientific research
that the brain response evoked by attended stimuli is different of those
unattended,
and determine which one of a set of targets was attended.
In turn, this can be coupled to an action, like typing the letter shown on the
stimulus.
The \ac{bci} paradigm comprises, if applicable, the manner of stimulation and the
exact task performed by the user, and is often closely linked to the manner of
feedback in the case of a closed-loop system.
As shown in Section~\ref{sec:bci-paradigms}, there is a wide variety of \ac{bci}
paradigms based on different systems in the brain.

The previous points to another component of a successful \ac{bci}: the specific
brain signals related to our paradigm need to be identified within the recorded
activity.
\todo{preprocessing}
This is commonly referred to as \emph{feature extraction}
In other words, the signal needs to be interpreted \emph{in function of} the
task we want our \ac{bci} to perform.
The electrical activity of the brain is relatively weak compared to that of the
environment around us, containing electronic devices and other sources of
interference.
Furthermore, the brain is continuously processing information and carrying out
`background tasks', all of which generate their own electrical signals.
On the other hand, the brain activity we are interested in exploiting often
originates from a specific functional system within the brain, and its activity
might not be easily discerned from all other neural and environmental activity,
akin to trying to listen to a single speaker in a noise environment where
everyone is shouting over each other.
Some obvious sources of interference can be easily filtered out, but to obtain
a good measure reflecting only the activity that is relevant for a given \ac{bci}
problem.
This problem is called \emph{decoding} and is often solved through supervised
machine learning.
Useful information that is encoded in the brain signal by the paradigm,
can be retrieved from it by the decoder.
Section~\label{sec:bci-decoding} takes a closer look at some common decoding
techniques.

Finally, the loop can be closed by coupling this to a
device or actuator.
There are two aspects to this.
On the one hand, the \ac{bci} gains its function by allowing the user to interact
with their environment.\todo{put focus on communication BCI}
On the other hand, the actions performed by the \ac{bci} can themselves influence
the user's brain activity, creating an adaptive system.
A direct form of closed-loop \ac{bci} is the use of a neurostimulator.
Examples of this are deep brain stimulation to mitigate the symptoms of
Parkinson's disease, or the cochlear implant as an auditive prosthesis.
More indirectly modulation can be achieved by sensory stimulation.
This can involve specific, paradigm-related sensory input, like haptic feedback when a
movement \ac{bci} detects an intended action, or simply presenting selected actions
back to the user.
The user's brain will then adapt through reinforcement learning, causing
changes in behavior or strategy.
Due to neuroplasticity, the brain's ability to adapt, this can have a positive
impact on \ac{bci} performance and opens the pathway to rehabilitation applications.

\todo{wrap-up}

\todo{check excercise session presentation}

\section{Recording technologies}
\label{sec:bci-recording}
\todo{make sure every part ends with a motivation for why we chose our
approach}

\todo{why is spatial resolution a good thing}
\todo{explain with each method what it actually is (e.g. electrodes placed
at...)}

The brain's activity can be recorded using various neuroimaging
technologies.
These can range from brain scans~\cite{Weiskopf2004} using functional magnetic resonance imaging
(fMRI) to more portable technologies like accoustic signals obtained by functional ultrasound imaging
(fUS)~\cite{Zheng2023} and near-infrared spectroscopy
(fNIRS)~\cite{Borgheai2020}.
These technologies all measure the hemodynamic signal, which only indirectly
reflects brain activity.
Because of the desirable high temporal resolution of
electrophysiology~\cite{Easttom2021} and
because of their practicality, we will focus only on methods to record
electromagnetical activity originating from neuronal action potentials.
The magnetical field of the brain can be measured using magnetoencephalography
(MEG)~\cite{Mellinger2007}.
While MEG is non-invasive and results in high-quality signals, it is relatively
impractical due to the size of the equipment needed.
Recent advances have been made using optically pumped magnetometers
(OPM-MEG)~\cite{Wittevrongel2021}, but this technology still falters outside of
lab conditions.

As a consequence, the \ac{bci} field relies heavily on the
electrical activity of the brain.
As mentioned earlier with MEG, an important concept in determining which
technology is suited for a \ac{bci} application is the \emph{invasiveness} of the technology.
As illustrated in Figure~\ref{fig:recording-modalities}, invasive electrodes can often measure a very specific brain region and can result in better signal quality, at the cost of the risks
involved with brain surgery.
\fullpagefigct{figures/bci/recording_modalities.pdf}{
	Different electrophysiology recording modalities and \\
	their respective position in a cross-section of the skull. \\
	There is a trade-off between invasiveness and  \\
	spatial resolution.
}{fig:recording-modalities}
\todo{find better figure with permission to reuse and without unnecessary
modalities}

Specifically, invasive methods come with an increased \emph{spatial resolution},
meaning they can extract a signal from a specific brain region or even a set of
neurons of interest.
Generally, penetrating microelectrodes are considered to have the highest
spatial resolution.
Microelectrodes can measure the Local Field Potential (LFP), the extracellular
potential of a small group of neurons, or even intracellular single neuron
action potential spikes.
They come in single-electrode form, or, more popularly, in microelectrode
arrays.
Well-known examples are the Utah array~\cite{Maynard1997} and the more recent
NeuraLink implant~\cite{Musk2019}.

Larger implanted electrodes are referred to as intracranial ac{eeg} (iac{eeg}).
Depth electrodes such as those used in stereo-ac{eeg} \ac{bci}~\cite{Wu2024} tasks
and closed-loop adaptive control for Deep Brain Stimulation to mitigate
Parkinson's disease symptoms~\cite{Arlotti2018}.
Since these still penetrate the cortex, electrodes that sit on top of the
cortex are more popular, as they are considered less invasive.
\ac{ecog} is a powerful method
with many applications in \ac{bci}~\cite{Schalk2011} and epilepsy diagnosis.
Newer developments like micro-ECoG (µECoG)~\cite{Shokoueinejad2019} with a
higher number of smaller electrodes per surface area allow for more precise
measurements.

Some impressive recent breakthroughs in speech and motor \ac{bci} for communication
\todo{cite} have been realized using
invasive mictroelectrode arrays~\cite{Willett2021} and high-density
\Ac{ecog}\cite{Metzger2023}.
Furthermore, recent advances in recording technology focus on improving implant
durability and resolution\todo{cite flexible}, and on balancing the invasiveness
tradeoff by finding new, minimally invasive ways to record from closer to the cortex.
The Synchron Stentrode~\cite{Mitchell2023}, for instance, can be delivered
through the bloodstream via a catheter, removing the need for open brain
surgery.
However, surveys~\cite{Huggins2011, Huggins2015, Branco2021} in different
potential communication \ac{bci} user groups consistently show that non-invasive
recording methods are preferred over implanted electrodes, unless the added value of invasive BCI is
sufficiently large~\cite{Kageyama2020}.\todo{due to what reasons}
This provides justification for focusing part of the current research effort on
non-invasive BCI.

\Ac{eeg} is the de facto non-invasive electrophysiology standard, in clinical
neurology practice as well as in \ac{bci} research.
Developed in 1924~\cite{Berger1929}, it is cheap and relatively practical and
can offer great temporal resolution up to thousands of Hz.
As it is easily applicable on the outside of the scalp, many practical
consumer grade \ac{eeg} headsets exist in the form (often wireless) electrode
caps or helmets.
Current consumer systems can feature dry electrodes, but clinical and
research systems often use electrolyte gel to reduce impedance for improved signal
quality, which slightly decreases practicality.
Nevertheless, it is the most accessible \ac{bci} technology for both patients
and researchers.

The major drawback of \ac{eeg} is its poor spatial resolution.
The electrodes are large and sit on the outside of the scalp, relatively far
away from the cortex.
Furthermore, the layers of skull and cerebrospinal fluid in between can
attenuate the signal and cause volume conduction, which results in electrodes
measuring a mixture of activity from sources elsewhere in the brain.
In addition to picking up brain activity other than that of the region of
interest, \ac{eeg} also records other artifacts, from the
environment, the power supply, nearby electrical equipment or the user's muscle
movements.
Combined, this means that \ac{eeg} is inherently noisy.

Despite its noisy nature \Ac{eeg} is the recording methodology of choice for
our \ac{bci} because of its wide acceptance by patients.
To counteract the noise present in our recording, we must on the one hand evoke
strong, informative brain signals using a suited \ac{bci} \emph{paradigm}, and on th
other hand pick a suited \emph{decoder} which can isolate the signal of
interest and filter out the noise.

\section{\ac{bci} Paradigms}
\label{sec:bci-paradigms}

The \ac{bci} paradigm~\cite{Xu2021} is the key to translating brain activity into useful
output commands, since it defines which neural responses will be elicited and
captured.
A paradigm can be loosely seen as \emph{a way of interacting with the
\ac{bci}}.
According to \textcite{Zander2011}, they can be arranged by their reliance on
external stimulation and the engagement of the user as shown in
Figure~\ref{fig:bci-paradigms}.

\fullpagefig{figures/bci/paradigms.eps}{
  A \ac{bci} paradigm defines which brain activity will be used for control.
  They can be categorized in \emph{active}, \emph{reactive} and \emph{passive}
  paradigms, depending on their reliance on external stimulation and active
  participation required from the user.
  Adapted from~\textcite{Muehl2014}.
}{fig:bci-paradigms}

Paradigms that require little active participation of the user like
redirecting attention or initiating imagined actions are classified as passive
\ac{bci}.
From the user's point of view, this concept is probably the most attractive,
since their intentions or cognitive state state would be inferred from just
their brain activity.
However, without active user participation, it can be hard to establish reliable
communication or control.
Therefore, passive \ac{bci} are currently more suited to tasks like
emotion or affect monitoring~\cite{Torres2020,Libert2019}, workload
monitoring~\cite{Zanetti2021} or, more dependent on stimulation, error
detection~\cite{SiMohammed2020}.

Furthermore, active paradigms make it easier to quickly collect training data for
supervized machine learning since the conditions can be more easily controlled
by the user or the stimulation.

active

reactive
works for most people
high effort, unintuitive and low expressive power compared to movement and
speech~\cite{Zander2011}, which are more natural and can be emulated with active bci

\todo{check permissions}
\todo{cite A comprehensive review of ac{eeg}-based brain–computer interface
paradigms}
passive:
also monitoring for diagnostic purposes
emotion recognition
neurofeedback
error potentials
cannot easily be used for fast communication
synchronous <-> asynchronous
Again, asynchronous is preferred by users because it is more intuitive and
comfortable to use, but it is far easier to decode synchronous responses since
it is known when to expect a response and when a decision should be made.

active:
motor imagery
imagined speech

reactive:

somatosensory evoked potentials~\cite{Petit2021} (cite jimmy)

auditory:
ERP/oddball, steady state

visual paradigms:
more performant since it allows us to use our visual system, the most adapted
sensory system in humans
SSVEP, cVEP, mVEP, VEP/P300/Oddball
high ssvep itr

hybrid

\section{Decoders}
\label{sec:bci-decoders}

After extracting features, machine learning algorithms can perform \ac{bci}
decoding.
This is usually based on
some training data for which the performed tasks are known, by recognize the
activity evoked by the task in recorded data.
The training data can be either obtained from the \ac{bci} user themselves or from
other users.
In the first case, the user would perform a short calibration session before
using the \ac{bci}, where they are instructed to perform a known task.
This calibration session can be eliminated by training the decoder on
preexisting labeled data from other sessions and users, but this is harder due
to the variability between subjects and sessions.\todo{make shorter, move part
to section}

\todo{regression/classification}
\todo{for communication, we want classification, focus on classification
further down the line}

If the goal is to eliminate the per-session calibration, one can also use a
decoder pre-trained on an existing dataset of the same task.
This is complicated by large variability in measured brain response between subjects
and even between different sessions within the same
subject~\cite{Guger2009,Saha2020}.
Therefore, pre-trained decoders must either be trained on a very large, diverse
sample of subjects, or some form of transfer learning must be applied.
Nevertheless, in practice pre-trained models or models using transfer learning often still
require some per session fine-tuning, which still necessitates some
calibration.
Instead, rather opt for keeping the calibration time as short as possible by using
an algorithm that can learn from very few training samples.
This can work well, but requires strong regularization~\cite{VanDenKerchove2022}.

\textcite{Lotte2018, Xu2021} present a relatively recent overview of state-of-the art
decoder algorithms.
Classic linear methods, such as \ac{csp} feature extraction for
motor imagery~\cite{Park2017} and \ac{cca} for \ac{ssvep}~\cite{Nakanishi2017},
and \ac{lda} for \ac{erp} classification~\cite{Sosulski2022} still perform
relatively well, given some regularizing constraints or extensions.
Multi-linear techniques exploiting the tensor structure of neural signals are
also promising.
Riemannian Geometry~\cite{Barachant2014} is a popular and robust new strategy,
Furthermore, they lend themselves well to application like adaptive
learning~\cite{Benaroch2021} or transfer learning~\cite{Zanini2017}
Riemannian Geometry classifiers are often considered the current
state-of-the-art.
Finally, deep learning\todo{Bhuvaneshwari2021} is also sometimes considered, albeit only when large
training datasets are available.
If decoders tailored to a specific user that keep the calibration session as
short as possible are of interest, not enough training data is available to
properly train a deep learning model.

Usually, a decoder makes a prediction for a given \emph{trial} while operating
the \ac{bci}.
A trial is the smallest unit on which a selection decision can be made, for
instance be one imagined movement, or one repetition of flashing all targets
in a visual \ac{erp} \ac{bci}.
Some valuable metrics to asses decoder performance in the classification case
are accuracy and \ac{rocauc}.
Accuracy can be obtained from the correctness of predicted trial selection as
\begin{equation}
  \text{accuracy} = \frac{\text{TP}+\text{TN}}{\text{TP}+\text{TN}+\text{FP}+\text{FN}}
\end{equation}
with TP and TN the numbers of true positives and negatives and FP and FP the
numbers of false positives and negatives.
\Ac{rocauc} is also a measure of classifier predictive power, but is more
suited for evaluation of classification of single epochs of data and in the
presence of imbalanced data, e.g. when
comparing single \acp{erp}.
Higer \ac{rocauc} usually translates to a higher target selection accuracy.

Finally, an important concept in the evaluation of a \ac{bci} decoder, and of \acp{bci}
in general, is \ac{itr}.
\Ac{itr} reflects how fluently a \ac{bci} can be used for communication and can
be calculated as
\begin{equation}
	\text{ITR} = Q\left(\log_2N+P\log_2P+(1-P)\log_2\frac{1-P}{N-1}\right)
\end{equation}
\Ac{itr} is expressed in bits/s and is dependent on $N$, the number of
different options that can be selected per trial, $P$, the selection accuracy
of the decoder, and $Q$, the number of trials per second.
The parameters $N$, $P$ and $Q$ of this formula give us some insight in the
building blocks a successful, high-\ac{itr} \ac{bci}.
To improve performance, we can aim to
\todo{enumerate}
\begin{enumerate*}[label={\arabic*})]
\item increase $N$ by selecting a paradigm and interface that offer a
broad range of informative selections per trial,
\item increase $P$ by engineering more performant machine learning methods for
decoding, and
\item increase $Q$ by selecting a paradigm and allows fast stimulation or
responses.
\end{enumerate*}


\section{A case study: the visual oddball ERP paradigm}
good choice because it scores high on the parameters above
\subsection{Stimulation}
comfortable, preferred over SSVEP, similar ITR is this true?
\todo{figure of P3 matrix}
\todo{cite P300 literature, first example and current sota}
\subsection{The event-related potential}
P300 and other components
does not only rely on P300, but also heavily dependent on visual early
components, hence we'll refer to it under the more generall oddball ERP
paradigm
\todo{figure of ERP components}
\subsection{Preprocessing and feature extraction}
referencing, filtering, epoching, baselining
\subsection{Decoding ERPs}
tLDA, beamforming
Linear decoding techniques
